{"backend_state":"ready","kernel":"anaconda5","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":77266944},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.6.6"}},"trust":true,"type":"settings"}
{"cell_type":"code","exec_count":0,"id":"72317f","input":"","pos":7,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":0,"id":"85791c","input":"# Define constants\nSpH=900  # J/(kg K)\nRho=2700 # kg/m3\nkap=220  # W/(m K)\n\n# Define parameters of the problem\nBarL=0.3 # m\nT0=100.  # C\n\ndX = 0.01\ndt = 0.5\nEta = (kap * dt) % (SpH * Rho * (sX**2))\n\n# Number of points along x and t. Note! We need to do 31 and 201 points to get the correct Delta X and Delta T. \ndef LeapFrog(NPx,NPt,tmax): #I have no idea what this is or why it is here\n\n#Get set of Xs & ts, in separate lists, then sum over them\n#Make some lists:\nXlist = np.arange(0, 100, dX)\ntlist = np.arange(0, 5000, dt) #So these are the same length to avoid errors that might come up\nTlist = []\n\n\nfor j in range (0, 9999)\n    for i in range (0, 9999)\n        Tlist[0] = 0\n        Tlist[j + 1] = Tlist[j] + Eta * (\n","pos":2,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"18de91","input":"# The Heat equation - part 2\n\n## Numerical solutions\nA solution can be found numerically using time steps with the so-called \"leap frog\" method. To do this we replace the derivative in time with the approximation\n$$\\frac{\\partial T(x,t)}{\\partial t} = \\frac{T(x,t+\\Delta t)-T(x,t)}{\\Delta t} + ...$$\nTo approximate the second derivative over $x$ we write\n$$T(x+\\Delta x,t ) = T(x,t) + \\frac{\\partial T(x,t)}{\\partial x} \\Delta x + \\frac{1}{2} \\frac{\\partial^2 T(x,t)}{\\partial x^2} (\\Delta x)^2+...$$\n$$T(x-\\Delta x,t ) = T(x,t) - \\frac{\\partial T(x,t)}{\\partial x} \\Delta x + \\frac{1}{2} \\frac{\\partial^2 T(x,t)}{\\partial x^2} (\\Delta x)^2+...$$\nAdding the two terms and solving for the second derivative we obtain\n$$\\frac{\\partial^2 T(x,t)}{\\partial x^2} = \\frac{1}{\\Delta x^2} \\left[T(x+\\Delta x)+T(x-\\Delta x)-2T(x,t) \\right]$$\nSubstituting both approximations in the heat equations\n$$\\frac{T(x,t+\\Delta t)-T(x,t)}{\\Delta t} = \\frac{k}{c \\rho} \\frac{1}{\\Delta x^2} \\left[T(x+\\Delta x)+T(x-\\Delta x)-2T(x,t) \\right]$$\nBy which we get\n$$T(x,t+\\Delta t)=T(x,t) + \\eta \\left[ T(x+\\Delta x)+T(x-\\Delta x)-2T(x,t) \\right] \\ \\ \\ , \\ \\eta=\\frac{k \\Delta t}{c \\rho \\Delta x^2} $$\nThus we can evaluate the value of $T(x,t+\\Delta t)$ once the value of $T(x,t)$ is known. The numerical method will consist in starting with the given initial condition at $t=0$ and propagate that forward in time, hence the name of \"leap frog\".\n\nCreate a matrix of points $T_{i,j}$ with intervals $\\Delta t$ and $\\Delta x$ and solve the equation using the leapfrog method:\n$$T_{i,j+1}=T_{i,j} + \\eta \\left[T_{i+1,j}+T_{i-1,j}-2T_{i,j} \\right], \\ \\ \\ \\eta=\\frac{k\\Delta t}{C \\rho \\Delta x^2}$$\nWhere we have indicated $x=i \\Delta x$ and $t=j \\Delta t$. Start by using $\\Delta x=0.01$m and $\\Delta t=0.5$s ","pos":0,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"247a03","input":"## Code the numerical solution\nWrite code to calculate $T_{ij}$ in a recursive manner. \n- Plot T(x,t) for t=0, 20, 100s and compare with the plot in Exercise 1\n- Repeat the 3-D $T(x,t)$ wireframe plot of Exercise 1. ","pos":1,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"2edd65","input":"## Compute performance (PHY428)\n- Using the leap-frog numerical solution, show the time needed to evaluate the first 100 s of the solution as a function of $\\Delta x$ and $\\Delta t$. Present two graphs, one where $\\Delta x$ is fixed and one when $\\Delta t$ is fixed. Mark on the graph where the $\\eta=0.5$ condition is reached.\n","pos":4,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"50f4a0","input":"### General reference\nThis project was inspired by Chapter 14 of the book \"Computational Physics\" by Laundau, Paez and Bordeianu published by Wiley. There should be a few copies available in the library. ","pos":6,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"a973f0","input":"## Stability study\nIn this section we evaluate how the quality of our solution depends on the choice of $\\Delta x$ and $\\Delta t$. We will not be able to find a stable solution if the value of $\\eta>0.5$. This can be checked using the cases below. For each of the 4 cases below calculate the value of $eta$ and plot $T(x,t=100s)$\n- Fix $\\Delta x = 0.01$ m and change the value of $\\Delta t$ to 0.2 s and 1 s. Compare the results with those obtained in exercise 2. \n- Fix $\\Delta t = 0.5$ s and change the value of $\\Delta x$ to 0.02 m and 0.005 m. Compare the results with those obtained in exercise 2.\n\nA mathematical proof of the instability for $\\eta>0.5$ is provided in addendum. \n","pos":3,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"b4b4dc","input":"## Addendum. Calculation of the stability limit\nYou noticed that the difference between the analytical solution and the leap frog solution exhibits wild fluctuations when the leap frog solution does not converge. When that happens the solution is not stable. To assess the value of the parameter for which we obtain a stable solution, we assume that the difference has eigenmodes:\n$$T_{m,j}=\\xi(\\lambda)^j \\exp \\left( {i \\frac{2\\pi}{\\lambda} m \\Delta x } \\right)$$\nWhere we use $i$ as the imaginary constant and $T_{m,j}$ refers to the temperature at time $j \\Delta t$ for the point $m \\Delta x$. \n\nThis formula tells us that any eigenmode in the difference gets amplified or damped at every iteration by a factor $\\xi$, which depends on the wavelength $\\lambda$ of the mode. Replacing the equation above into the formula used for the leap-frog method we obtain:\n$$\\xi(\\lambda)^{j+1} \\exp \\left(i \\frac{2\\pi}{\\lambda} m \\Delta x \\right) = \\xi(\\lambda)^{j} \\exp \\left(i \\frac{2\\pi}{\\lambda} m \\Delta x  \\right)+ \\eta \\left[  \\exp \\left(i \\frac{2\\pi}{\\lambda} (m+1) \\Delta x  \\right)  + \\exp \\left(i \\frac{2\\pi}{\\lambda} (m-1) \\Delta x  \\right) -2 \\exp \\left(i \\frac{2\\pi}{\\lambda} m \\Delta x  \\right)   \\right]$$\n\nDividing both sides of the equation by $ \\xi(\\lambda)^{j} \\exp \\left(i \\frac{2\\pi}{\\lambda} m \\Delta x \\right)$ we obtain:\n$$\\xi(\\lambda) = 1 + 2 \\eta \\left[ \\cos \\left( \\frac{2\\pi}{\\lambda} m \\Delta x  \\right) -1 \\right] $$\n\nFor the quantity $|\\xi|<1$ for any value of $x$, we need to have $\\eta < 0.5$\n","pos":5,"state":"done","type":"cell"}
{"id":0,"time":1550668420982,"type":"user"}
{"last_load":1550065084263,"type":"file"}
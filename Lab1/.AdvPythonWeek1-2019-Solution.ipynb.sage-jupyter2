{"backend_state":"running","kernel":"anaconda3","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":88866816},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.5.5"}},"trust":true,"type":"settings"}
{"cell_type":"code","end":1550100409303,"exec_count":3,"id":"9a17d2","input":"# Define constants\nSpH=900  # J/(kg K)\nRho=2700 # kg/m3\nkap=220  # W/(m K)\n\n# Define parameters of the problem\nBarL=0.3 # m\nT0=100.  # C\n\n# import statements\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n","kernel":"anaconda3","pos":2,"start":1550100409292,"state":"done","type":"cell"}
{"cell_type":"code","end":1550100415990,"exec_count":4,"id":"b5f7e6","input":"from mpl_toolkits.mplot3d import Axes3D\n# Complete the code below for the Nth term\n# n-th term calculation. Here we pass an array in x and return an array in y. \n\n#TAsk 1\ndef TTermN(xs,t,n): ##Returns T_n\n    an = (n*np.pi/BarL)\n    return ((4*T0)/(n*np.pi))*np.sin(an*xs)*np.exp(-((an**2)*kap*t)/(SpH*Rho)) \n\n\n#TAsk 3\ndef Tsum(xs, t): ##Sums all values of T for n=1 to n=99\n    T = []\n    for i in range(50):\n        an = ((2*i+1)*np.pi/BarL)\n        T.append( ((4*T0)/((2*i+1)*np.pi))*np.sin(an*xs)*np.exp(-((an**2)*kap*t)/(SpH*Rho)) )\n    Tsum = sum(T)\n    return(Tsum)\n\n#TAsk 2\nxs=np.linspace(0, BarL, 100)\n\nplt.plot(xs, TTermN(xs,0,1), label = 'n=1') ##Plots T_n for t=0\nplt.plot(xs, TTermN(xs,0,3), label = 'n=3')\nplt.plot(xs, TTermN(xs,0,5), label = 'n=5')\nplt.xlabel('X')\nplt.ylabel('Temperature')\nplt.legend()\nplt.show()\n\n\nplt.plot(xs, TTermN(xs,20,1), label = 'n=1') ##Plots T_n for t=20\nplt.plot(xs, TTermN(xs,20,3), label = 'n=3')\nplt.plot(xs, TTermN(xs,20,5), label = 'n=5')\nplt.xlabel('X')\nplt.ylabel('Temperature')\nplt.legend()\nplt.show()\n\nprint(\"HIGH N GIVES SMALL T\")\n\n#Task 3 - Plots T values for n=1->99 at t=0, 20, 100 on 1 graph\nplt.plot(xs, Tsum(xs, 0), label = 't=0')\n# plt.show()\nplt.plot(xs, Tsum(xs, 20), label = 't=20')\n# plt.show()\nplt.plot(xs, Tsum(xs, 100), label = 't=100')\nplt.xlabel('X')\nplt.ylabel('Temperature')\nplt.legend()\nplt.show()\n\n\n#Task 4\nxs3d = np.linspace(0, BarL, 100)\nts3d = np.linspace(0, 100, 100)\nX, T = np.meshgrid(xs3d, ts3d)\n\nfig = plt.figure() ##3d plot of T, as a function of x & t\nax = fig.gca(projection = '3d')\nax.plot_wireframe(X, T, Tsum(X, T))\n\nfig2 = plt.figure() ##Heatmap of T, as a function of x & t\ncon = plt.contourf(X, T, Tsum(X, T))\ncbar = fig2.colorbar(con)\ncbar.set_label('Temperature')\nplt.xlabel('X')\nplt.ylabel('Time')","kernel":"anaconda3","output":{"0":{"data":{"image/png":"778c61f785e955bd3cf7357654891bae51a42cce"},"metadata":{"image/png":{"height":263,"width":392}}},"1":{"data":{"image/png":"485281d05df2278dc21f8b91ba67e690ab058578"},"metadata":{"image/png":{"height":263,"width":390}}},"2":{"name":"stdout","text":"HIGH N GIVES SMALL T\n"},"3":{"data":{"image/png":"3084bf43cbecae73563057765fd4301831030cd1"},"metadata":{"image/png":{"height":263,"width":390}}},"4":{"data":{"text/plain":"Text(0,0.5,'Time')"},"exec_count":4},"5":{"data":{"image/png":"a0a93ed1cbafe38522d7e1b9e65a3361fa65d5ac"},"metadata":{"image/png":{"height":235,"width":352}}},"6":{"data":{"image/png":"a886a19cf34224d0264442737f8f2311a63e2a0e"},"metadata":{"image/png":{"height":265,"width":389}}}},"pos":3,"start":1550100412193,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":0,"id":"9485a2","input":"","pos":4,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"15d605","input":"## Question: Sum the members of the series and produce a few plots\nThis exercise will jog your memory on how to add vectors, write a function, plot a few graphs. These are all basic python skills that you have developed in your previous courses.\n\nThe analytical solution is presented as an infinite serie of terms. \n- Write a function that calculates $T_n(x,t)$, e.g. the n-th term of the serie as a function of $x$ and $t$. You should pass an array for x, so this can be used for the calculations and plots in the questions below\n- Plot two graphs, each with the first three terms of the serie (n=1,3,5) in different colours. One graph for for t=0s and one for t=20s. Choose an appropriate number of points along $x$. How does the maximum $T$ depend on $n$ for $t=20s$? Why?  \n- Add the first 50 terms (up to $n=99$) of the serie and plot a graph of $T(x,t)$ for t=0, 20, 100 s. If enough points are used in the $x$ coordinate a ripple is visible in the graph for $t=0$ s. Explain this. \n- Produce a 3D plot showing $T(x,t)$ for t up to 100 s, when adding the first 50 terms. Plot as a wireframe and as a colour temperature map","pos":1,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"4a4fe0","input":"# The Heat equation - part 1\n\n## A few theoretical remarks\nHeat propagation is described by the differential equation (for a one-dimensional system)\n$$\\frac{\\partial T(x,t)}{\\partial t} = \\frac{k}{C \\rho} \\frac{\\partial^2 T(x,t)}{\\partial x^2},$$\nwhich describes the variation of temperature ($T$) as a function of a coordinate ($x$) and time ($t$).  $k$ is the thermal conductivity, $C$ is the heat capacity and $\\rho$ the density of a material.\n\nAn analytical solution can be found by separating the variables $x$ and $t$\n$$T(x,t)=X(x)\\cal{T} (t)$$\nSubstituting into the original equation, we can rewrite this as two non-coupled ordinary differential equations (ODE) as a function of the $t$ and $x$ variables.\n$$\\frac{d \\cal{T}}{dt} (t) + \\alpha^2 \\frac{k}{C \\rho} {\\cal T}(t) = 0, \\ \\ \\ \\ \\frac{d^2 X}{d x^2}(x) + \\alpha^2 X(x)=0,$$\nwhere $\\alpha$ is a real number. These are ordinary differential equations, the solutions can be found for set values of $\\alpha$. When multiple values of $\\alpha$ are allowed, the corresponding solutions need to be added up.\n\nFor this project we consider a bar of length $L=0.3$ m with the boundary conditions $T(0,t)=T(L,t)=0$ C, e.g. with the two edges kept at a constant temperature of 0 C. We also assume the initial condition $T(x,0)=T_0=100$C for 0<x<L.\n\nThe boundary condition requires a solution for $X(x)$ of the type:\n$$X(x)=\\sin \\alpha_n x \\ \\ \\mbox{with} \\ \\ \\alpha_n=n \\pi/L$$\nConsequently the solution for $\\cal{T}(t)$ is written in the form:\n$${\\cal T}(t)=\\exp{\\left( -\\frac{\\alpha_n^2 kt}{C \\rho} \\right) } $$\nWhich leads to the generic solution\n$$T(x,t) = \\sum_{n=1}^{\\infty} A_n \\sin (\\alpha_n x) \\exp{\\left( -\\frac{\\alpha_n^2 kt}{C \\rho} \\right) }, $$\n\nTo satisfy the initial condition, we can derive the factors $A_n$ of the Fourier serie and write the analytical solution as\n$$T(x,t) = \\sum_{n=1, 3, 5, ...}^{\\infty} T_n(x,t) = \\sum_{n=1, 3, 5, ...}^{\\infty} \\frac{4T_0}{n \\pi} \\sin (\\alpha_n x) \\exp{\\left( -\\frac{\\alpha_n^2 kt}{C \\rho} \\right) }, $$\n\n\nIn your numerical implementation use Aluminium as a metal with heat conductivity $k=220$ W/(m K), density $\\rho=2700$ kg/m$^3$ and specific heat $C=900$ J/(kg K). \n\nPlease **note**, for simplicity we use temperatures in Celsius. Using Kelvin would require adding a constant of T=273.16K, which, being a constant, would disappear from the differential equation.\n\n","pos":0,"state":"done","type":"cell"}
{"id":0,"time":1559429106360,"type":"user"}
{"last_load":1550091559802,"type":"file"}